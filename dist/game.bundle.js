(()=>{let t,e,n,o,i,r,d=document.querySelector("canvas"),h=d.getContext("2d"),c=document.querySelector(".start"),l=document.querySelector(".score"),a=0,u=0,w=0,f=5,s=0,g=40,y=[],v=document.querySelector(".block-1");v.addEventListener("touchmove",(function(t){if(t.preventDefault(),!m||!M)return;let e=t.touches[0],n=e.clientX-m,o=e.clientY-M;Math.abs(n)>Math.abs(o)?n>0?(f=5,s=0):(f=-5,s=0):o>0?(s=5,f=0):(s=-5,f=0),m=null,M=null})),v.addEventListener("touchstart",(function(t){let e=t.touches[0];m=e.clientX,M=e.clientY}));let m=null,M=null;function L(){(u>=d.width-t||u<0||w>=d.height-e||w<0)&&(clearInterval(r),alert("Вы умерли, ваш счёт: "+a),S()),h.clearRect(0,0,d.width,d.height),y.unshift({x:u,y:w}),y.length>g/t&&y.pop();for(let n=0;n<y.length;n++)h.fillRect(y[n].x,y[n].y,t,e);u=(u+f+d.width)%d.width,w=(w+s+d.height)%d.height,h.fillStyle="red",h.fillRect(o,i,n,n),u<o+n&&u+t>o&&w<i+n&&w+e>i&&(o=Math.floor(Math.random()*d.width),i=Math.floor(Math.random()*d.height),g+=200,a++,p())}function S(){a=0,f=5,s=0,u=0,w=0,y=[],g=40,p()}function p(){l.textContent=a%10==1&&a%100!=11?"Вы собрали "+a+" яблоко":a%10>=2&&a%10<=4&&!(a%100>=12&&a%100<=14)?"Вы собрали "+a+" яблока":"Вы собрали "+a+" яблок"}function A(){d.width=window.innerWidth,d.height=window.innerHeight,t=.02*d.width,e=.02*d.width,n=.02*d.width,o=Math.floor(Math.random()*d.width),i=Math.floor(Math.random()*d.height)}window.addEventListener("resize",A),document.addEventListener("keydown",(function(t){t.preventDefault(),"KeyS"==t.code||"ArrowDown"==t.code?(s=5,f=0):"KeyD"==t.code||"ArrowRight"==t.code?(f=5,s=0):"KeyA"==t.code||"ArrowLeft"==t.code?(f=-5,s=0):"KeyW"!=t.code&&"ArrowUp"!=t.code||(s=-5,f=0)})),c.addEventListener("click",(function(){S(),A(),r=setInterval(L,40)}))})();